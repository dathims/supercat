!function(){var a,b,c="3.6.3";!function(){function c(b){var c=b.factory,d=function(c){var d=c;return"."===c.charAt(0)&&(d=b.id.slice(0,b.id.lastIndexOf(g))+g+c.slice(2)),a(d)};return b.exports={},delete b.factory,c(d,b.exports,b),b.exports}var d={},e=[],f={},g=".";a=function(a){if(!d[a])throw"module "+a+" not found";if(a in f){var b=e.slice(f[a]).join("->")+"->"+a;throw"Cycle in require graph: "+b}if(d[a].factory)try{return f[a]=e.length,e.push(a),c(d[a])}finally{delete f[a],e.pop()}return d[a].exports},b=function(a,b){if(d[a])throw"module "+a+" already defined";d[a]={id:a,factory:b}},b.remove=function(a){delete d[a]},b.moduleMap=d}(),"object"==typeof module&&"function"==typeof a&&(module.exports.require=a,module.exports.define=b),b("cordova",function(a,d,e){function f(a,b){var c=document.createEvent("Events");if(c.initEvent(a,!1,!1),b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}var g=a("cordova/channel"),h=a("cordova/platform"),i=document.addEventListener,j=document.removeEventListener,k=window.addEventListener,l=window.removeEventListener,m={},n={};document.addEventListener=function(a,b,c){var d=a.toLowerCase();"undefined"!=typeof m[d]?m[d].subscribe(b):i.call(document,a,b,c)},window.addEventListener=function(a,b,c){var d=a.toLowerCase();"undefined"!=typeof n[d]?n[d].subscribe(b):k.call(window,a,b,c)},document.removeEventListener=function(a,b,c){var d=a.toLowerCase();"undefined"!=typeof m[d]?m[d].unsubscribe(b):j.call(document,a,b,c)},window.removeEventListener=function(a,b,c){var d=a.toLowerCase();"undefined"!=typeof n[d]?n[d].unsubscribe(b):l.call(window,a,b,c)};var o={define:b,require:a,version:c,platformId:h.id,addWindowEventHandler:function(a){return n[a]=g.create(a)},addStickyDocumentEventHandler:function(a){return m[a]=g.createSticky(a)},addDocumentEventHandler:function(a){return m[a]=g.create(a)},removeWindowEventHandler:function(a){delete n[a]},removeDocumentEventHandler:function(a){delete m[a]},getOriginalHandlers:function(){return{document:{addEventListener:i,removeEventListener:j},window:{addEventListener:k,removeEventListener:l}}},fireDocumentEvent:function(a,b,c){var d=f(a,b);"undefined"!=typeof m[a]?c?m[a].fire(d):setTimeout(function(){"deviceready"==a&&document.dispatchEvent(d),m[a].fire(d)},0):document.dispatchEvent(d)},fireWindowEvent:function(a,b){var c=f(a,b);"undefined"!=typeof n[a]?setTimeout(function(){n[a].fire(c)},0):window.dispatchEvent(c)},callbackId:Math.floor(2e9*Math.random()),callbacks:{},callbackStatus:{NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9},callbackSuccess:function(a,b){try{o.callbackFromNative(a,!0,b.status,[b.message],b.keepCallback)}catch(c){console.log("Error in success callback: "+a+" = "+c)}},callbackError:function(a,b){try{o.callbackFromNative(a,!1,b.status,[b.message],b.keepCallback)}catch(c){console.log("Error in error callback: "+a+" = "+c)}},callbackFromNative:function(a,b,c,d,e){var f=o.callbacks[a];f&&(b&&c==o.callbackStatus.OK?f.success&&f.success.apply(null,d):b||f.fail&&f.fail.apply(null,d),e||delete o.callbacks[a])},addConstructor:function(a){g.onCordovaReady.subscribe(function(){try{a()}catch(b){console.log("Failed to run constructor: "+b)}})}};e.exports=o}),b("cordova/argscheck",function(a,b,c){function d(a,b){return/.*?\((.*?)\)/.exec(a)[1].split(", ")[b]}function e(a,b,c,e){if(h.enableChecks){for(var f,j=null,k=0;k<a.length;++k){var l=a.charAt(k),m=l.toUpperCase(),n=c[k];if("*"!=l&&(f=g.typeName(n),(null!==n&&void 0!==n||l!=m)&&f!=i[m])){j="Expected "+i[m];break}}if(j)throw j+=", but got "+f+".",j='Wrong type for parameter "'+d(e||c.callee,k)+'" of '+b+": "+j,"undefined"==typeof jasmine&&console.error(j),TypeError(j)}}function f(a,b){return void 0===a?b:a}var g=(a("cordova/exec"),a("cordova/utils")),h=c.exports,i={A:"Array",D:"Date",N:"Number",S:"String",F:"Function",O:"Object"};h.checkArgs=e,h.getValue=f,h.enableChecks=!0}),b("cordova/base64",function(a,b){function c(a){for(var b,c=a.byteLength,d="",e=g(),h=0;c-2>h;h+=3)b=(a[h]<<16)+(a[h+1]<<8)+a[h+2],d+=e[b>>12],d+=e[4095&b];return c-h==2?(b=(a[h]<<16)+(a[h+1]<<8),d+=e[b>>12],d+=f[(4095&b)>>6],d+="="):c-h==1&&(b=a[h]<<16,d+=e[b>>12],d+="=="),d}var d=b;d.fromArrayBuffer=function(a){var b=new Uint8Array(a);return c(b)},d.toArrayBuffer=function(a){for(var b="undefined"!=typeof atob?atob(a):new Buffer(a,"base64").toString("binary"),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0,f=b.length;f>e;e++)d[e]=b.charCodeAt(e);return c};var e,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=function(){e=[];for(var a=0;64>a;a++)for(var b=0;64>b;b++)e[64*a+b]=f[a]+f[b];return g=function(){return e},e}}),b("cordova/builder",function(a,b){function c(a,b,c){for(var d in a)a.hasOwnProperty(d)&&b.apply(c,[a[d],d])}function d(a,c,d){b.replaceHookForTesting(a,c),a[c]=d,a[c]!==d&&h.defineGetter(a,c,function(){return d})}function e(a,b,c,e){e?h.defineGetter(a,b,function(){return console.log(e),delete a[b],d(a,b,c),c}):d(a,b,c)}function f(b,d,i,j){c(d,function(c,d){try{var k=c.path?a(c.path):{};i?("undefined"==typeof b[d]?e(b,d,k,c.deprecated):"undefined"!=typeof c.path&&(j?g(b[d],k):e(b,d,k,c.deprecated)),k=b[d]):"undefined"==typeof b[d]?e(b,d,k,c.deprecated):k=b[d],c.children&&f(k,c.children,i,j)}catch(l){h.alert("Exception building Cordova JS globals: "+l+' for key "'+d+'"')}})}function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a.prototype&&a.prototype.constructor===a?d(a.prototype,c,b[c]):"object"==typeof b[c]&&"object"==typeof a[c]?g(a[c],b[c]):d(a,c,b[c]))}var h=a("cordova/utils");b.buildIntoButDoNotClobber=function(a,b){f(b,a,!1,!1)},b.buildIntoAndClobber=function(a,b){f(b,a,!0,!1)},b.buildIntoAndMerge=function(a,b){f(b,a,!0,!0)},b.recursiveMerge=g,b.assignOrWrapInDeprecateGetter=e,b.replaceHookForTesting=function(){}}),b("cordova/channel",function(a,b,c){function d(a){if("function"!=typeof a)throw"Function required as first argument!"}var e=a("cordova/utils"),f=1,g=function(a,b){this.type=a,this.handlers={},this.state=b?1:0,this.fireArgs=null,this.numHandlers=0,this.onHasSubscribersChange=null},h={join:function(a,b){for(var c=b.length,d=c,e=function(){--d||a()},f=0;c>f;f++){if(0===b[f].state)throw Error("Can only use join with sticky channels.");b[f].subscribe(e)}c||a()},create:function(a){return h[a]=new g(a,!1)},createSticky:function(a){return h[a]=new g(a,!0)},deviceReadyChannelsArray:[],deviceReadyChannelsMap:{},waitForInitialization:function(a){if(a){var b=h[a]||this.createSticky(a);this.deviceReadyChannelsMap[a]=b,this.deviceReadyChannelsArray.push(b)}},initializationComplete:function(a){var b=this.deviceReadyChannelsMap[a];b&&b.fire()}};g.prototype.subscribe=function(a,b){if(d(a),2==this.state)return void a.apply(b||this,this.fireArgs);var c=a,g=a.observer_guid;"object"==typeof b&&(c=e.close(b,a)),g||(g=""+f++),c.observer_guid=g,a.observer_guid=g,this.handlers[g]||(this.handlers[g]=c,this.numHandlers++,1==this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())},g.prototype.unsubscribe=function(a){d(a);var b=a.observer_guid,c=this.handlers[b];c&&(delete this.handlers[b],this.numHandlers--,0===this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())},g.prototype.fire=function(){var a=Array.prototype.slice.call(arguments);if(1==this.state&&(this.state=2,this.fireArgs=a),this.numHandlers){var b=[];for(var c in this.handlers)b.push(this.handlers[c]);for(var d=0;d<b.length;++d)b[d].apply(this,a);2==this.state&&this.numHandlers&&(this.numHandlers=0,this.handlers={},this.onHasSubscribersChange&&this.onHasSubscribersChange())}},h.createSticky("onDOMContentLoaded"),h.createSticky("onNativeReady"),h.createSticky("onCordovaReady"),h.createSticky("onPluginsReady"),h.createSticky("onDeviceReady"),h.create("onResume"),h.create("onPause"),h.createSticky("onDestroy"),h.waitForInitialization("onCordovaReady"),h.waitForInitialization("onDOMContentLoaded"),c.exports=h}),b("cordova/exec",function(a,b,c){function d(){var a=document.createElement("iframe");return a.style.display="none",document.body.appendChild(a),a}function e(){var a=d();return a.contentWindow.history.replaceState(null,null,"file:///#"),a}function f(){if(m===t.XHR_WITH_PAYLOAD)return!0;if(m===t.XHR_OPTIONAL_PAYLOAD){for(var a=0,b=0;b<x.length;++b)a+=x[b].length;return 4500>a}return!1}function g(a){if(!a||"Array"!=r.typeName(a))return a;var b=[];return a.forEach(function(a){b.push("ArrayBuffer"==r.typeName(a)?{CDVType:"ArrayBuffer",data:s.fromArrayBuffer(a)}:a)}),b}function h(a){if("ArrayBuffer"==a.CDVType){var b=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b.buffer},c=function(a){return b(atob(a))};a=c(a.data)}return a}function i(a){var b=[];return a&&a.hasOwnProperty("CDVType")?"MultiPart"==a.CDVType?a.messages.forEach(function(a){b.push(h(a))}):b.push(h(a)):b.push(a),b}function j(){void 0===m&&(m=navigator.userAgent?-1==navigator.userAgent.indexOf(" 5_")?t.IFRAME_NAV:t.XHR_NO_PAYLOAD:t.IFRAME_NAV),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.cordova&&window.webkit.messageHandlers.cordova.postMessage&&(m=t.WK_WEBVIEW_BINDING);var a,b,c,d,e,f,h=null;if("string"!=typeof arguments[0])a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],h="INVALID";else try{return f=arguments[0].split("."),d=f.pop(),c=f.join("."),e=Array.prototype.splice.call(arguments,1),void console.log('The old format of this exec call has been removed (deprecated since 2.1). Change to: cordova.exec(null, null, "'+c+'", "'+d+'",'+JSON.stringify(e)+");")}catch(i){}e=e||[],(a||b)&&(h=c+q.callbackId++,q.callbacks[h]={success:a,fail:b}),e=g(e);var j=[h,c,d,e];if(x.push(JSON.stringify(j)),m===t.WK_WEBVIEW_BINDING)window.webkit.messageHandlers.cordova.postMessage(j);else if(!y&&1==x.length)switch(m){case t.XHR_NO_PAYLOAD:case t.XHR_WITH_PAYLOAD:case t.XHR_OPTIONAL_PAYLOAD:k();break;default:l()}}function k(){p&&4!=p.readyState&&(p=null),p=p||new XMLHttpRequest,p.open("HEAD","/!gap_exec?"+ +new Date,!0),w||(w=/.*\((.*)\)/.exec(navigator.userAgent)[1]),p.setRequestHeader("vc",w),p.setRequestHeader("rc",++v),f()&&p.setRequestHeader("cmds",j.nativeFetchMessages()),p.send(null)}function l(){if(!document.body)return void setTimeout(l);if(m===t.IFRAME_HASH_NO_PAYLOAD||m===t.IFRAME_HASH_WITH_PAYLOAD){o=o||e(),o.contentWindow||(o=e()),u=3^u;var a="%0"+u;m===t.IFRAME_HASH_WITH_PAYLOAD&&(a+=j.nativeFetchMessages()),o.contentWindow.location.hash=a}else n=n||d(),n.contentWindow||(n=d()),n.src="gap://ready"}var m,n,o,p,q=a("cordova"),r=(a("cordova/channel"),a("cordova/utils")),s=a("cordova/base64"),t={IFRAME_NAV:0,XHR_NO_PAYLOAD:1,XHR_WITH_PAYLOAD:2,XHR_OPTIONAL_PAYLOAD:3,IFRAME_HASH_NO_PAYLOAD:4,IFRAME_HASH_WITH_PAYLOAD:5,WK_WEBVIEW_BINDING:6},u=1,v=0,w=null,x=[],y=0;j.jsToNativeModes=t,j.setJsToNativeBridgeMode=function(a){n&&(n.parentNode.removeChild(n),n=null),m=a},j.nativeFetchMessages=function(){if(!x.length)return"";var a="["+x.join(",")+"]";return x.length=0,a},j.nativeCallback=function(a,b,c,d){return j.nativeEvalAndFetch(function(){var e=0===b||1===b,f=i(c);q.callbackFromNative(a,e,b,f,d)})},j.nativeEvalAndFetch=function(a){y++;try{return a(),j.nativeFetchMessages()}finally{y--}},c.exports=j}),b("cordova/exec/proxy",function(a,b,c){var d={};c.exports={add:function(a,b){return console.log("adding proxy for "+a),d[a]=b,b},remove:function(a){var b=d[a];return delete d[a],d[a]=null,b},get:function(a,b){return d[a]?d[a][b]:null}}}),b("cordova/init",function(a){function b(a){for(var b=0;b<a.length;++b)2!=a[b].state&&console.log("Channel not fired: "+a[b].type)}function c(a){var b=function(){};b.prototype=a;var c=new b;if(b.bind)for(var d in a)"function"==typeof a[d]&&(c[d]=a[d].bind(a));return c}var d=a("cordova/channel"),e=a("cordova"),f=a("cordova/modulemapper"),g=a("cordova/platform"),h=a("cordova/pluginloader"),i=[d.onNativeReady,d.onPluginsReady];window.setTimeout(function(){2!=d.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),b(i),b(d.deviceReadyChannelsArray))},5e3),window.navigator&&(window.navigator=c(window.navigator)),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(a){this.log("warn: "+a)}),d.onPause=e.addDocumentEventHandler("pause"),d.onResume=e.addDocumentEventHandler("resume"),d.onDeviceReady=e.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?d.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",function(){d.onDOMContentLoaded.fire()},!1),window._nativeReady&&d.onNativeReady.fire(),f.clobbers("cordova","cordova"),f.clobbers("cordova/exec","cordova.exec"),f.clobbers("cordova/exec","Cordova.exec"),g.bootstrap&&g.bootstrap(),setTimeout(function(){h.load(function(){d.onPluginsReady.fire()})},0),d.join(function(){f.mapModules(window),g.initialize&&g.initialize(),d.onCordovaReady.fire(),d.join(function(){a("cordova").fireDocumentEvent("deviceready")},d.deviceReadyChannelsArray)},i)}),b("cordova/init_b",function(a){function b(a){for(var b=0;b<a.length;++b)2!=a[b].state&&console.log("Channel not fired: "+a[b].type)}function c(a){var b=function(){};b.prototype=a;var c=new b;if(b.bind)for(var d in a)"function"==typeof a[d]&&(c[d]=a[d].bind(a));return c}var d=a("cordova/channel"),e=a("cordova"),f=a("cordova/platform"),g=[d.onDOMContentLoaded,d.onNativeReady];e.exec=a("cordova/exec"),window.setTimeout(function(){2!=d.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),b(g),b(d.deviceReadyChannelsArray))},5e3),window.navigator&&(window.navigator=c(window.navigator)),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(a){this.log("warn: "+a)}),d.onPause=e.addDocumentEventHandler("pause"),d.onResume=e.addDocumentEventHandler("resume"),d.onDeviceReady=e.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?d.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",function(){d.onDOMContentLoaded.fire()},!1),window._nativeReady&&d.onNativeReady.fire(),f.bootstrap&&f.bootstrap(),d.join(function(){f.initialize&&f.initialize(),d.onCordovaReady.fire(),d.join(function(){a("cordova").fireDocumentEvent("deviceready")},d.deviceReadyChannelsArray)},g)}),b("cordova/modulemapper",function(a,c){function d(a,b,c,d){if(!(b in i))throw new Error("Module "+b+" does not exist.");f.push(a,b,c),d&&(g[c]=d)}function e(a,b){if(!a)return b;for(var c,d=a.split("."),e=b,f=0;c=d[f];++f)e=e[c]=e[c]||{};return e}var f,g,h=a("cordova/builder"),i=b.moduleMap;c.reset=function(){f=[],g={}},c.clobbers=function(a,b,c){d("c",a,b,c)},c.merges=function(a,b,c){d("m",a,b,c)},c.defaults=function(a,b,c){d("d",a,b,c)},c.runs=function(a){d("r",a,null)},c.mapModules=function(b){var c={};b.CDV_origSymbols=c;for(var d=0,i=f.length;i>d;d+=3){var j=f[d],k=f[d+1],l=a(k);if("r"!=j){var m=f[d+2],n=m.lastIndexOf("."),o=m.substr(0,n),p=m.substr(n+1),q=m in g?"Access made to deprecated symbol: "+m+". "+q:null,r=e(o,b),s=r[p];"m"==j&&s?h.recursiveMerge(s,l):("d"==j&&!s||"d"!=j)&&(m in c||(c[m]=s),h.assignOrWrapInDeprecateGetter(r,p,l,q))}}},c.getOriginalSymbol=function(a,b){var c=a.CDV_origSymbols;if(c&&b in c)return c[b];for(var d=b.split("."),e=a,f=0;f<d.length;++f)e=e&&e[d[f]];return e},c.reset()}),b("cordova/platform",function(a,b,c){c.exports={id:"ios",bootstrap:function(){a("cordova/channel").onNativeReady.fire()}}}),b("cordova/pluginloader",function(a,c){function d(a,d,e,f){f=f||e,a in b.moduleMap?e():c.injectScript(d,function(){a in b.moduleMap?e():f()},f)}function e(a,b){for(var c,d=0;c=a[d];d++){if(c.clobbers&&c.clobbers.length)for(var e=0;e<c.clobbers.length;e++)h.clobbers(c.id,c.clobbers[e]);if(c.merges&&c.merges.length)for(var f=0;f<c.merges.length;f++)h.merges(c.id,c.merges[f]);c.runs&&h.runs(c.id)}b()}function f(a,b,c){function f(){--g||e(b,c)}var g=b.length;if(!g)return void c();for(var h=0;h<b.length;h++)d(b[h].id,a+b[h].file,f)}function g(){for(var a=null,b=document.getElementsByTagName("script"),c="/cordova.js",d=b.length-1;d>-1;d--){var e=b[d].src.replace(/\?.*$/,"");if(e.indexOf(c)==e.length-c.length){a=e.substring(0,e.length-c.length)+"/";break}}return a}{var h=a("cordova/modulemapper");a("cordova/urlutil")}c.injectScript=function(a,b,c){var d=document.createElement("script");d.onload=b,d.onerror=c,d.src=a,document.head.appendChild(d)},c.load=function(b){var c=g();null===c&&(console.log("Could not find cordova.js script tag. Plugin loading may fail."),c=""),d("cordova/plugin_list",c+"cordova_plugins.js",function(){var d=a("cordova/plugin_list");f(c,d,b)},b)}}),b("cordova/urlutil",function(a,b){b.makeAbsolute=function(a){var b=document.createElement("a");return b.href=a,b.href}}),b("cordova/utils",function(a,b){function c(a){for(var b="",c=0;a>c;c++){var d=parseInt(256*Math.random(),10).toString(16);1==d.length&&(d="0"+d),b+=d}return b}var d=b;d.defineGetterSetter=function(a,b,c,d){if(Object.defineProperty){var e={get:c,configurable:!0};d&&(e.set=d),Object.defineProperty(a,b,e)}else a.__defineGetter__(b,c),d&&a.__defineSetter__(b,d)},d.defineGetter=d.defineGetterSetter,d.arrayIndexOf=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=a.length,d=0;c>d;++d)if(a[d]==b)return d;return-1},d.arrayRemove=function(a,b){var c=d.arrayIndexOf(a,b);return-1!=c&&a.splice(c,1),-1!=c},d.typeName=function(a){return Object.prototype.toString.call(a).slice(8,-1)},d.isArray=function(a){return"Array"==d.typeName(a)},d.isDate=function(a){return"Date"==d.typeName(a)},d.clone=function(a){if(!a||"function"==typeof a||d.isDate(a)||"object"!=typeof a)return a;var b,c;if(d.isArray(a)){for(b=[],c=0;c<a.length;++c)b.push(d.clone(a[c]));return b}b={};for(c in a)c in b&&b[c]==a[c]||(b[c]=d.clone(a[c]));return b},d.close=function(a,b,c){return"undefined"==typeof c?function(){return b.apply(a,arguments)}:function(){return b.apply(a,c)}},d.createUUID=function(){return c(4)+"-"+c(2)+"-"+c(2)+"-"+c(2)+"-"+c(6)},d.extend=function(){var a=function(){};return function(b,c){a.prototype=c.prototype,b.prototype=new a,b.__super__=c.prototype,b.prototype.constructor=b}}(),d.alert=function(a){window.alert?window.alert(a):console&&console.log&&console.log(a)}}),window.cordova=a("cordova"),a("cordova/init")}(),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};this.WebSocketRails=function(){function b(b,c){this.url=b,this.use_websockets=null!=c?c:!0,this.connection_stale=a(this.connection_stale,this),this.pong=a(this.pong,this),this.supports_websockets=a(this.supports_websockets,this),this.dispatch_channel=a(this.dispatch_channel,this),this.unsubscribe=a(this.unsubscribe,this),this.subscribe_private=a(this.subscribe_private,this),this.subscribe=a(this.subscribe,this),this.dispatch=a(this.dispatch,this),this.trigger_event=a(this.trigger_event,this),this.trigger=a(this.trigger,this),this.bind=a(this.bind,this),this.connection_established=a(this.connection_established,this),this.new_message=a(this.new_message,this),this.reconnect=a(this.reconnect,this),this.callbacks={},this.channels={},this.queue={},this.connect()}return b.prototype.connect=function(){return this.state="connecting",this._conn=this.supports_websockets()&&this.use_websockets?new b.WebSocketConnection(this.url,this):new b.HttpConnection(this.url,this),this._conn.new_message=this.new_message},b.prototype.disconnect=function(){return this._conn&&(this._conn.close(),delete this._conn._conn,delete this._conn),this.state="disconnected"},b.prototype.reconnect=function(){var a,b,c,d,e;c=null!=(d=this._conn)?d.connection_id:void 0,this.disconnect(),this.connect(),e=this.queue;for(b in e)a=e[b],a.connection_id!==c||a.is_result()||this.trigger_event(a);return this.reconnect_channels()},b.prototype.new_message=function(a){var c,d,e,f,g,h;for(g=[],d=0,e=a.length;e>d;d++)h=a[d],c=new b.Event(h),c.is_result()?(null!=(f=this.queue[c.id])&&f.run_callbacks(c.success,c.data),delete this.queue[c.id]):c.is_channel()?this.dispatch_channel(c):c.is_ping()?this.pong():this.dispatch(c),g.push("connecting"===this.state&&"client_connected"===c.name?this.connection_established(c.data):void 0);return g},b.prototype.connection_established=function(a){return this.state="connected",this._conn.setConnectionId(a.connection_id),this._conn.flush_queue(),null!=this.on_open?this.on_open(a):void 0},b.prototype.bind=function(a,b){var c;return null==(c=this.callbacks)[a]&&(c[a]=[]),this.callbacks[a].push(b)},b.prototype.trigger=function(a,c,d,e){var f,g;return f=new b.Event([a,c,null!=(g=this._conn)?g.connection_id:void 0],d,e),this.trigger_event(f)},b.prototype.trigger_event=function(a){var b,c;return null==(b=this.queue)[c=a.id]&&(b[c]=a),this._conn&&this._conn.trigger(a),a},b.prototype.dispatch=function(a){var b,c,d,e,f;if(null!=this.callbacks[a.name]){for(e=this.callbacks[a.name],f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b(a.data));return f}},b.prototype.subscribe=function(a,c,d){var e;return null==this.channels[a]?(e=new b.Channel(a,this,!1,c,d),this.channels[a]=e,e):this.channels[a]},b.prototype.subscribe_private=function(a,c,d){var e;return null==this.channels[a]?(e=new b.Channel(a,this,!0,c,d),this.channels[a]=e,e):this.channels[a]},b.prototype.unsubscribe=function(a){return null!=this.channels[a]?(this.channels[a].destroy(),delete this.channels[a]):void 0},b.prototype.dispatch_channel=function(a){return null!=this.channels[a.channel]?this.channels[a.channel].dispatch(a.name,a.data):void 0},b.prototype.supports_websockets=function(){return"function"==typeof WebSocket||"object"==typeof WebSocket},b.prototype.pong=function(){var a,c;return a=new b.Event(["websocket_rails.pong",{},null!=(c=this._conn)?c.connection_id:void 0]),this._conn.trigger(a)},b.prototype.connection_stale=function(){return"connected"!==this.state},b.prototype.reconnect_channels=function(){var a,b,c,d,e;d=this.channels,e=[];for(c in d)b=d[c],a=b._callbacks,b.destroy(),delete this.channels[c],b=b.is_private?this.subscribe_private(c):this.subscribe(c),b._callbacks=a,e.push(b);return e},b}()}.call(this),function(){WebSocketRails.Event=function(){function a(a,b,c){var d;this.success_callback=b,this.failure_callback=c,this.name=a[0],d=a[1],null!=d&&(this.id=null!=d.id?d.id:65536*(1+Math.random())|0,this.channel=null!=d.channel?d.channel:void 0,this.data=null!=d.data?d.data:d,this.token=null!=d.token?d.token:void 0,this.connection_id=a[2],null!=d.success&&(this.result=!0,this.success=d.success))}return a.prototype.is_channel=function(){return null!=this.channel},a.prototype.is_result=function(){return"undefined"!=typeof this.result},a.prototype.is_ping=function(){return"websocket_rails.ping"===this.name},a.prototype.serialize=function(){return JSON.stringify([this.name,this.attributes()])},a.prototype.attributes=function(){return{id:this.id,channel:this.channel,data:this.data,token:this.token}},a.prototype.run_callbacks=function(a,b){return this.success=a,this.result=b,this.success===!0?"function"==typeof this.success_callback?this.success_callback(this.result):void 0:"function"==typeof this.failure_callback?this.failure_callback(this.result):void 0},a}()}.call(this),function(){WebSocketRails.AbstractConnection=function(){function a(a,b){this.dispatcher=b,this.message_queue=[]}return a.prototype.close=function(){},a.prototype.trigger=function(a){return"connected"!==this.dispatcher.state?this.message_queue.push(a):this.send_event(a)},a.prototype.send_event=function(a){return null!=this.connection_id?a.connection_id=this.connection_id:void 0},a.prototype.on_close=function(a){var b;return this.dispatcher&&this.dispatcher._conn===this?(b=new WebSocketRails.Event(["connection_closed",a]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(b)):void 0},a.prototype.on_error=function(a){var b;return this.dispatcher&&this.dispatcher._conn===this?(b=new WebSocketRails.Event(["connection_error",a]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(b)):void 0},a.prototype.on_message=function(a){return this.dispatcher&&this.dispatcher._conn===this?this.dispatcher.new_message(a):void 0},a.prototype.setConnectionId=function(a){this.connection_id=a},a.prototype.flush_queue=function(){var a,b,c,d;for(d=this.message_queue,b=0,c=d.length;c>b;b++)a=d[b],this.trigger(a);return this.message_queue=[]},a}()}.call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;WebSocketRails.HttpConnection=function(b){function c(a,b){var d;this.dispatcher=b,c.__super__.constructor.apply(this,arguments),this._url="http://"+a,this._conn=this._createXMLHttpObject(),this.last_pos=0;try{this._conn.onreadystatechange=function(a){return function(){return a._parse_stream()}}(this),this._conn.addEventListener("load",this.on_close,!1)}catch(e){d=e,this._conn.onprogress=function(a){return function(){return a._parse_stream()}}(this),this._conn.onload=this.on_close,this._conn.readyState=3}this._conn.open("GET",this._url,!0),this._conn.send()}return a(c,b),c.prototype.connection_type="http",c.prototype._httpFactories=function(){return[function(){return new XDomainRequest},function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}]},c.prototype.close=function(){return this._conn.abort()},c.prototype.send_event=function(a){return c.__super__.send_event.apply(this,arguments),this._post_data(a.serialize())},c.prototype._post_data=function(a){return $.ajax(this._url,{type:"POST",data:{client_id:this.connection_id,data:a},success:function(){}})},c.prototype._createXMLHttpObject=function(){var a,b,c,d,e,f;for(f=!1,b=this._httpFactories(),d=0,e=b.length;e>d;d++){c=b[d];try{f=c()}catch(g){a=g;continue}break}return f},c.prototype._parse_stream=function(){var a,b,c;if(3===this._conn.readyState){a=this._conn.responseText.substring(this.last_pos),this.last_pos=this._conn.responseText.length,a=a.replace(/\]\]\[\[/g,"],[");try{return c=JSON.parse(a),this.on_message(c)}catch(d){b=d}}},c}(WebSocketRails.AbstractConnection)}.call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;WebSocketRails.WebSocketConnection=function(b){function c(a,b){this.url=a,this.dispatcher=b,c.__super__.constructor.apply(this,arguments),this.url.match(/^wss?:\/\//)?console.log("WARNING: Using connection urls with protocol specified is depricated"):this.url="https:"===window.location.protocol?"wss://"+this.url:"ws://"+this.url,this._conn=new WebSocket(this.url),this._conn.onmessage=function(a){return function(b){var c;return c=JSON.parse(b.data),a.on_message(c)}}(this),this._conn.onclose=function(a){return function(b){return a.on_close(b)}}(this),this._conn.onerror=function(a){return function(b){return a.on_error(b)}}(this)}return a(c,b),c.prototype.connection_type="websocket",c.prototype.close=function(){return this._conn.close()},c.prototype.send_event=function(a){return c.__super__.send_event.apply(this,arguments),this._conn.send(a.serialize())},c}(WebSocketRails.AbstractConnection)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};WebSocketRails.Channel=function(){function b(b,c,d,e,f){var g,h,i;this.name=b,this._dispatcher=c,this.is_private=null!=d?d:!1,this.on_success=e,this.on_failure=f,this._failure_launcher=a(this._failure_launcher,this),this._success_launcher=a(this._success_launcher,this),this._callbacks={},this._token=void 0,this._queue=[],h=this.is_private?"websocket_rails.subscribe_private":"websocket_rails.subscribe",this.connection_id=null!=(i=this._dispatcher._conn)?i.connection_id:void 0,g=new WebSocketRails.Event([h,{data:{channel:this.name}},this.connection_id],this._success_launcher,this._failure_launcher),this._dispatcher.trigger_event(g)}return b.prototype.destroy=function(){var a,b,c;return this.connection_id===(null!=(c=this._dispatcher._conn)?c.connection_id:void 0)&&(b="websocket_rails.unsubscribe",a=new WebSocketRails.Event([b,{data:{channel:this.name}},this.connection_id]),this._dispatcher.trigger_event(a)),this._callbacks={}},b.prototype.bind=function(a,b){var c;return null==(c=this._callbacks)[a]&&(c[a]=[]),this._callbacks[a].push(b)},b.prototype.trigger=function(a,b){var c;return c=new WebSocketRails.Event([a,{channel:this.name,data:b,token:this._token},this.connection_id]),this._token?this._dispatcher.trigger_event(c):this._queue.push(c)},b.prototype.dispatch=function(a,b){var c,d,e,f,g,h;if("websocket_rails.channel_token"===a)return this.connection_id=null!=(f=this._dispatcher._conn)?f.connection_id:void 0,this._token=b.token,this.flush_queue();if(null!=this._callbacks[a]){for(g=this._callbacks[a],h=[],d=0,e=g.length;e>d;d++)c=g[d],h.push(c(b));return h}},b.prototype._success_launcher=function(a){return null!=this.on_success?this.on_success(a):void 0},b.prototype._failure_launcher=function(a){return null!=this.on_failure?this.on_failure(a):void 0},b.prototype.flush_queue=function(){var a,b,c,d;for(d=this._queue,b=0,c=d.length;c>b;b++)a=d[b],this._dispatcher.trigger_event(a);return this._queue=[]},b}()}.call(this),angular.module("supercatApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","geolocation","ngMaterial","restangular","LocalStorageModule","angularMoment"]).constant("envConfig",{url_prod:"https://supertiger.herokuapp.com",url_dev:"http://localhost:3000"}).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/dashboard.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignupCtrl"}).when("/signin",{templateUrl:"views/signin.html",controller:"SigninCtrl"}).when("/discover",{templateUrl:"views/discover.html",controller:"DiscoverCtrl"}).when("/create-room",{templateUrl:"views/create-room.html",controller:"CreateRoomCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/dashboard",{templateUrl:"views/dashboard.html",controller:"MainCtrl"}).when("/channels/:id",{templateUrl:"views/channels/show.html",controller:"ChannelCtrl"}).when("/channel",{templateUrl:"views/channel.html",controller:"ChannelCtrl"}).otherwise({redirectTo:"/login"})}]).config(["RestangularProvider","envConfig",function(a,b){a.setBaseUrl(b.url_dev),a.setRequestSuffix(".json"),a.setDefaultHeaders({"Content-Type":"application/json",Accept:"application/json"})}]).config(["localStorageServiceProvider",function(a){a.setPrefix("_supercat")}]).run(["localStorageService","Restangular",function(a,b){a.get("user")&&(b.configuration.defaultHeaders["X-CSRF-Token"]=a.get("user").auth_token)}]),angular.module("supercatApp").controller("MainCtrl",["Restangular","$scope","localStorageService","$location","geolocation",function(a,b,c,d,e){e.getLocation().then(function(a){b.coords={lat:a.coords.latitude,"long":a.coords.longitude},c.set("local",b.coords)}),c.isSupported&&(!c.get("local"),c.get("user")?(b.user=c.get("user"),b.user.gravatar=b.user.email_md5):d.url("/signin"))}]),angular.module("supercatApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("supercatApp").controller("SignupCtrl",["$scope","$location","geolocation","Restangular","localStorageService",function(a,b,c,d,e){a.user={},c.getLocation().then(function(b){a.coords={lat:b.coords.latitude,"long":b.coords.longitude}}),a.submit=function(){console.log(a.user);var c=d.all("users"),f=c.post({user:a.user}).then(function(a){console.log(a);var c="user",g=a;e.isSupported&&e.set(c,g),d.configuration.defaultHeaders["X-CSRF-Token"]=a.auth_token,b.path("/dashboard"),console.log(f)
})}}]),angular.module("supercatApp").controller("SigninCtrl",["$scope","$location","geolocation","Restangular","localStorageService",function(a,b,c,d,e){e.isSupported&&e.get("user")&&b.path("dashboard"),a.user={},c.getLocation().then(function(b){a.coords={lat:b.coords.latitude,"long":b.coords.longitude}}),a.displayPassword=!0,a.togglePassword=function(){a.displayPassword=!a.displayPassword},a.submit=function(){var c=d.all("users");a.displayPassword?(console.log(a.user),c.customPOST({user:a.user},"sign_in").then(function(a){console.log(a);var c="user",f=a;e.isSupported&&e.set(c,f),d.configuration.defaultHeaders["X-CSRF-Token"]=a.auth_token,b.path("/dashboard")})):c.customPOST({user:a.user},"password").then(function(a){console.log(a),b.path("/dashboard")})}}]),angular.module("supercatApp").controller("DiscoverCtrl",["Restangular","$scope",function(a,b){b.list={};var c=a.all("channels");c.getList().then(function(a){b.list=a})}]),angular.module("supercatApp").controller("CreateRoomCtrl",["Restangular","$scope","localStorageService","$location",function(a,b,c,d){b.channel={};var e=a.all("channels");b.geo=c.get("local"),b.user=c.get("user"),b.channel.longitude=b.geo["long"],b.channel.latitude=b.geo.lat,b.createChannel=function(){e.post({channel:b.channel}).then(function(){d.path("/dashboard")})}}]),angular.module("supercatApp").controller("LoginCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("supercatApp").controller("GlobalCtrl",["$scope",function(a){a.isVisible="true"}]),angular.module("supercatApp").controller("NavigationCtrl",["$scope","localStorageService","$location","$rootScope",function(a,b,c){a.toggleNav=function(){a.toggleNavOpen=!a.toggleNavOpen,console.log(a.toggleNavOpen)},a.disconnectProfil=function(){return c.path("/login"),b.clearAll()}}]).directive("ngClickOrig",["$parse",function(a){return{compile:function(b,c){var d=a(c.ngClickOrig);return function(a,b){b.on("click",function(b){a.$apply(function(){d(a,{$event:b})})})}}}}]),angular.module("supercatApp").controller("UserCtrl",function(){}),angular.module("supercatApp").controller("ChannelCtrl",["$scope","$routeParams","geolocation","Restangular","localStorageService","$location",function(a,b,c,d,e,f){function g(a,b,c){var d=a.scrollTop,e=b-d,f=0,g=20,h=function(){f+=g;var b=Math.easeInOutQuad(f,d,e,c);a.scrollTop=b,c>f&&setTimeout(h,g)};h()}var h=new WebSocketRails("localhost:3000/websocket"),i=h.subscribe("channel_"+b.id);a.local=e.get("local");e.get("user");a.message={latitude:a.local.lat,longitude:a.local["long"],body:""},e.get("user")?(a.user=e.get("user"),a.user.gravatar=a.user.email_md5):f.url("/login");var j=function(a,b,c,d){var e=6371,f=.5-Math.cos((c-a)*Math.PI/180)/2+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*(1-Math.cos((d-b)*Math.PI/180))/2;return 2*e*Math.asin(Math.sqrt(f))},k=function(){g(document.querySelector(".chat-messages"),document.querySelector(".chat-messages").scrollHeight,600)};Math.easeInOutQuad=function(a,b,c,d){return a/=d/2,1>a?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b)},i.bind("new_message",function(b){c.getLocation().then(function(b){a.local={lat:b.coords.latitude,"long":b.coords.longitude},e.set("local",a.local)}),a.$apply(function(){a.channel.messages.push(b)}),k()}),d.one("channels",b.id).get().then(function(b){a.channel=b;for(var c=0;c<a.channel.messages.length;c++){var d=a.channel.messages[c].latitude,e=a.channel.messages[c].longitude,f=a.local.lat,h=a.local["long"];a.channel.messages[c].distance=j(d,e,f,h)}setTimeout(function(){g(document.querySelector(".chat-messages"),document.querySelector(".chat-messages").scrollHeight,600)},300)}),a.sendMessage=function(){a.message.body&&a.channel.all("messages").post({message:a.message}).then(function(){a.message.body=""})},e.get("user")?(a.user=e.get("user"),a.user.gravatar=a.user.email_md5):f.url("/login")}]),angular.module("supercatApp").factory("UserServ",["$scope","$location","Restangular","localStorageService",function(a,b,c,d){var e={};return e.authent=function(){d.get("user")?(a.user=d.get("user"),a.user.gravatar=a.user.email_md5):b.url("/login"),console.log("user authent")},e}]);